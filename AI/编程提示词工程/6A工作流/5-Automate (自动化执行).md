# 阶段5: Automate (自动化执行)

目标: 按节点执行 → 编写测试 → 实现代码 → 文档同步

1. 逐步实施原子任务

    ```md
    按 docs/<待开发需求>/TASK_<待开发需求>.md 中的依赖关系排序，逐步实施原子任务
    1. 创建 docs/<待开发需求>/原子任务/ACCEPTANCE_[原子任务名].md 记录完成情况
    2. 执行前检查(验证输入契约、环境准备、依赖满足)
    3. 编写单元测试(边界条件、异常情况)
        - 测试优先：先写测试，后写实现
        - 边界覆盖：
            - 正常流程：覆盖正常的业务场景
            - 边界条件：测试边界值，如空字符串、边界整数、边界日期等
            - 异常情况：测试异常输入、异常状态、异常环境等
        - 集成测试：确保模块间正确集成
    4. 实现核心逻辑(按设计文档编写代码)
    5. 日志记录：
        - 使用 trycatch 包裹整个代码块，且在异常日志中要打印异常对象，catch 后不要再向外抛异常。
        - 添加必要的中文日志，日志内容应包含问题定位的关键信息，例如：异常原因、方法入参和出参、异常堆栈等，复杂类型使用 JSON.toJSONString 工具转换为字符串。
        - 日志格式要清晰易懂，包含异常堆栈的日志。示例代码，`logger.error("签约失败，异常信息：{}，paramId：{}，param：{}”, e.getMessage(), paramId, JSON.toJSONString(param), eStack)`。其中`param`代表复杂参数，`eStack`代表异常堆栈，编码中需要将param*等字符替换为实际方法参数名称。
    6. 运行验证测试，每完成一个任务立即验证
    7. 更新相关文档
    ```

2. 代码质量要求

    ```md
    - 基于 docs/<待开发需求>/TASK_<待开发需求>.md 的描述编写代码，不要捏造内容
    - 禁止使用伪代码以及省略代码
    - 严格遵循项目现有代码规范
    - 将代码文件放置到合适的路径下，优先选择已存在的路径
    - 请确保良好的代码模块分离和设计
    - 优先复用项目现有的组件、工具和库，避免重复造轮子
    - 设计必要的参数校验、事务管理及异常处理
    - 代码尽量精简易读
    - 添加必要的注释
    ```

3. 安全规范

    ```md
    - API KEY放到.env文件中并且不要提交git
    - 实施输入验证和输出编码
    - 避免直接在代码中硬编码敏感信息
    ```

4. 异常处理

    ```md
    - 遇到不确定问题立刻中断执行
    - 在 docs/<待开发需求>/原子任务/ACCEPTANCE_[原子任务名].md 文档中记录问题详细信息和位置
    - 寻求人工澄清后继续
    ```
